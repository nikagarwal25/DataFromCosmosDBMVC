@{
    ViewBag.Title = "All Shipment From Production";
}

@model TestFromProdWebApp.Models.SearchViewModel

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <table class="table table-bordered">
                <tr>
                    <td>Service Name</td>
                    <td>
                        @Html.DropDownList("Shipment_ServiceName", new SelectList(ViewBag.ServiceNameList, "Text", "Value"))
                    </td>
                    <td>Scenario</td>
                    <td>
                        @Html.DropDownList("Shipment_Scenario", new SelectList(ViewBag.ScenariosList, "Text", "Value"))
                    </td>
                    <td>SalesOrder Type</td>
                    <td>
                        @Html.DropDownList("Shipment_SalesOrderType", new SelectList(ViewBag.SalesOrderTypeList, "Text", "Value"))
                    </td>
                    <td>Sender Name</td>
                    <td>
                        @Html.DropDownList("Shipment_SenderName", new SelectList(ViewBag.SenderNameList, "Text", "Value"))
                    </td>
                </tr>
            </table>

            <button type="button" id="btnSearch" class="btn btn-primary">Search</button>
        </div>
    </div>
    <div class="row">
       <div class="col-md-12" id="divSearchResult">
           @Html.Partial("SearchResult", Model.ShipmentResult);
       </div>

    </div>

</div>

<script>
    $(document).ready(function () {
        $("#btnSearch").click(function () {
            var Shipment = {};
            Shipment.ServiceName = $("#Shipment_ServiceName").val();
            Shipment.Scenario = $("#Shipment_Scenario").val();
            Shipment.SalesOrderType = $("#Shipment_SalesOrderType").val();
            Shipment.SenderName = $("#Shipment_SenderName").val();
            Loading(true);
            $.ajax({
                method: "Post",
                url: "@Url.Action("SearchHomePage", "Home")",
                data: Shipment
            }).then(function success(data) {
                
                $("#divSearchResult").html(data);
                Loading(false);
                });
           
        });

        $("#divSearchResult").on("click", ".btnpost", function () {
            debugger;
            var correlationId = $("#postToService").closest('tr').find('.correlationId').text();
            var serviceName = $("#postToService").closest('tr').find('.servicename').text();
            var environ = $('.env').val();
            Loading(true);
            $.ajax({
                method: "Post",
                url: "@Url.Action("PostToService", "Home")",
                data: {
                    "correlationId": correlationId, "environment": environ, "serviceName": serviceName }
            }).then(function success(data) {
                //here we will get the response
                $("#divSearchResult").html(data);
                Loading(false);
                });
           
        });
    });
</script>